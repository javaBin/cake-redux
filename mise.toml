[tools]
java = "25"
maven = "latest"

[tasks.infrastructure]
run = [
    """
     if ! netstat -an | grep -q '[.:]5432\\b'; then
       echo "Starter Infrastrutur..."
       docker compose up --wait
     else
       echo "Infrastruturen kj√∏rer allerede"
     fi
    """,
    ""
]

[tasks.destroy-infrastructure]
run = [
    "docker compose down -v"
]

[tasks.start]
env = {SLEEPINGPILL_BASE_LOCATION="http://localhost:8082", NO_AUTH_MODE="true", SERVER_PORT="5000", CAKE_LOCATION="localhost"}
run = [
    "mvn clean package",
    "java -jar -Xmx512m -Djava.net.preferIPv4Stack=true -Dfile.encoding=UTF-8 target/cake-redux.jar-jar-with-dependencies.jar env-only"
]
